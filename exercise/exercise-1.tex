\documentclass[11pt]{jarticle}

\usepackage{amsmath}
\usepackage{hyperref}

\setlength{\oddsidemargin}{-0.7cm}
\setlength{\topmargin}{-1.5cm}
\setlength{\textwidth}{16.5cm}
\setlength{\textheight}{26cm}
\pagestyle{empty}

\begin{document}

\noindent
{\bf\large 「計算機実験I」実習課題 (2021/06/16更新)}
\\[-0.5em]

\noindent
課題は順次追加・修正の可能性あり\\[-0.5em]

\noindent
課題番号のあとに[応用]とあるのは少し高度な課題\\[-0.5em]

\noindent {\bf [数値誤差・アルゴリズム基礎]}
\begin{enumerate}
\renewcommand{\labelenumi}{1-\arabic{enumi})}

\item C言語における倍精度実数({\tt double})、単精度実数({\tt float})の有効桁数、最大値、(正の)最小値を確認するプログラムを作成せよ。また、IEEE規格において、零や無限大がどのように表現されるか調べよ
  
\item フィボナッチ数列($a_{n+2}=a_{n+1}+a_n$ ($n \ge 0$), $a_0=0$, $a_1=1$)を計算するプログラムを作成し、$a_{20}$, $a_{30}$, $a_{40}$, $a_{50}$, $a_{60}$を求めよ。桁あふれに注意すること。結果をMATLABで計算した値と比較し、\LaTeX の{\tt tabular}環境を使って表にまとめよ
  
\item $f(x)=\cos x$について、$x=0.3\pi$における$f'(x)$の値を数値微分により計算するプログラムを作成せよ。数値微分の刻みを$h=1,1/2,1/4,1/8,\cdots$と減少させていった時、誤差がどのように振る舞うか図示せよ。一次近似(前進差分)と二次近似(中心差分)における誤差の振る舞いの違いを調べよ。同様に、$x=0.3\pi$における$f''(x)$の値を数値微分により計算し、その誤差を評価せよ
  
\item $f(x)=\tanh x + 0.2 x + 0.3 = 0$の解をNewton法および二分法により求めよ。反復にしたがって、値がどのように真の解(MATLABで求めよ)に近づいていくか図示せよ。また、初期値による収束の違いを調べ、その理由について考察せよ
  
\item 黄金分割法において、左右の領域の幅の比が適当な値から出発した時、どのように黄金比に近づくのか考察せよ。また、実際にプログラムを走らせて考察が正しいかどうか確認せよ

\item \mbox{} [応用] 代数方程式の解をすべてもとめる方法について調べよ。Durand-Kerner-Aberth法を用いて、代数方程式の全ての解を求めるプログラムを作成せよ。方程式の次数を増やすにつれ、収束までにかかる時間がどのように増えるか調べよ

\end{enumerate}

\noindent {\bf [常微分方程式]}
\begin{enumerate}

\renewcommand{\labelenumi}{2-\arabic{enumi})}
\item 空気による摩擦のあるバネの問題を考える。壁にバネが繋がれ、バネの先には質量$m$の物体が繋がっている。床との摩擦は考えないものとする。バネの伸びる方向に$x$座標を取り、自然長の位置を原点とすると、物体の運動方程式は以下のように与えられる。
  \[
  m\frac{\mathrm{d} ^2x}{\mathrm{d} t^2} = -kx - \kappa \frac{\mathrm{d} x}{\mathrm{d} t} 
  \]
  ここで、$k$はバネ定数、$\kappa$は摩擦の比例定数とする。Euler法を使い$x(t)$を$t=30$まで計算せよ。その際、刻み幅$h$の大きさを変化させ、解の変わる様子を確認せよ。ただし、$k=2$、$\kappa = 0.2$、$m = 1$、初期条件は$x(0) = 10$、$x'(0) = 0$とする。さらに、3次のRunge-Kutta法、4次のRunge-Kutta法を用いて同様の計算を行い、精度の向上の様子を調べよ

\item 古典調和振動子$H=\frac{1}{2}(p^2+q^2)$をオイラー法、4次のRunge-Kutta法により解き、全エネルギー時間変化の様子を観察せよ。次に、逆オイラー法、リープ・フロッグ法を用いて計算を行い、全エネルギーのゆらぎの刻み幅$h$依存性を調べよ

\item Numerov法とシューティング法を用いて、一次元井戸型ポテンシャル中の粒子のシュレディンガー方程式の固有エネルギーと固有関数の組をいくつか求めよ
  
\item \mbox{} [応用] 方程式によっては、刻み幅を小さくしても、なかなか精度が上がらないものがある．一つの例として、``硬い方程式''知られている。``硬い方程式''とは何か、これを精度良く解くためにはどうすれば良いか調べよ。また、具体的な問題について計算を行ってみよ

\end{enumerate}

\noindent {\bf [連立一次方程式]}
\begin{enumerate}
\renewcommand{\labelenumi}{3-\arabic{enumi})}

\item {\tt cmatrix.h}を利用し、(何らかの意味で)ランダムな実対称行列、複素エルミート行列、実直交行列、複素ユニタリー行列を生成し、さらに、実際に生成された行列がそれらの性質を満たしているかチェックするプログラムを作成・実行せよ

  \item 行列・行列積の計算を行うサンプルプログラム{\tt multiply.c}とBLASライブラリを使ってそれと等価な計算を行う{\tt multiply\_dgemm.c}の速度を比較せよ\footnote{aiでは、OS付属のBLAS、LAPACKではなく、Intel製のMKL (Math Kernel Library)に含ま
れるBLASやLAPACKを利用するのがよい。MKLを使うには、GNU Cコンパイラ({\tt cc}, {\tt gcc})の代わりにIntel Cコンパイラ({\tt icc})を使い、{\tt -llapack -lblas}の代わりに{\tt -mkl}を指定してリンクする。例: \underline{\tt icc -O3 multiply\_dgemm.c -mkl}}。行列サイズによっては数十倍もの性能差が出ことがあるが、BLASで使われてい
る最適化手法について調べてみよ

\item LU分解を用いて行列の行列式を計算するプログラムを作成せよ。$n \times n$のVandermonde行列($v_{ij}=x_j^{i-1}$) ($x_1 \cdots x_n$は実数)の行列式を計算し、厳密な値$\displaystyle \prod_{1 \le i < j \le n} (x_j-x_i)$と比較せよ
  
\item LU分解を用いてDirichlet型の境界条件のもとでの二次元Laplace方程式の解を求めるプログラムを作成せよ。適当な境界条件[例えば$u(0,y) = \sin(2 \pi y)$, $u(1,y) = \sin(\pi y)$, $u(x,0)=u(x,1)=0$]や電荷分布を仮定して解を計算し、gnuplotの{\tt splot}コマンドを用いて解をプロットせよ。また、メッシュ数を増やすと、解の形や計算時間がどのように変化するか調べよ\footnote{計算時間の測り方:ハンドブック1.1.6節}

\item 非線形連立方程式
  \begin{align*}
    & f(x,y) = x^2 + y^2 - 1 = 0 \\
    & g(x,y) = x^2(2+x) - y^2 (2-x) = 0
  \end{align*}
  を多次元のニュートン法を用いて解け。ヤコビ行列の逆行列をかける代わりに、LU分解で線形連立方程式を解くこと

\item ヤコビ法を用いて、二次元のLaplace方程式の解を求めるプログラムを作成せよ

\item \mbox{} [応用] ガウス・ザイデル法、SOR法を用いて、二次元のLaplace方程式の解を求めるプログラムを作成せよ。収束までの回数を比較せよ。特にSOR法の場合、パラメータ$\omega$の選び方により、どのように収束回数が変化するか観察し、最適な$\omega$の値について考察せよ

\item \mbox{} [応用] 共分散行列$\Sigma$で与えられる$n$次元ガウス分布に従う乱数を生成する方法を考えよ。プログラムを作成して共分散を評価し、正しい乱数が生成されているか確認せよ

\end{enumerate}

\noindent {\bf [対角化]}
\begin{enumerate}
\renewcommand{\labelenumi}{4-\arabic{enumi})}
    
\item ハウスホルダー法による対角化のサンプルプログラム{\tt diag.c}に、得られた固有ベクトルが互いに正規直交していることや得られた固有値の精度を確認するコードを追加し実行せよ。また、複素エルミート行列に対して同様のプログラムを作成・実行せよ

\item 適当なポテンシャルの形を仮定した一次元シュレディンガー方程式の固有エネルギーと固有関数の組をハウスホルダー法により求めよ。同じ方程式を課題2-3)の方法で解き、解を比較せよ

\item 対角成分は$(n,n)$成分のみが1でそれ以外は全て2、副対角成分$(i, i \pm 1)$は全て-1の$n \times n$三重対角行列を考える。その固有値は、
  \[ \lambda_k = 2 (1 - \cos (\pi (2 k - 1) / (2 n + 1))) \ \ (k=1,\cdots,n)\]
  で与えられる。べき乗法を用いて、最大固有値を計算するプログラムを作成し、その結果を理論式と比較せよ\footnote{式では添字は1から始まっているが、C言語では0から始まることに注意}

\item ファイル{\tt measurement1.dat}に、ある実験で得られたデータが収められている。1カラム目は$x$、2カラム目は$y$、3カラム目は$y$の誤差の値である。最小二乗法によりデータを多項式でフィッティングするプログラムを作成せよ。多項式の最大次数を大きくしていくとフィッティング結果はどのように変化するか？何次の多項式を使うのが最も良いと考えられるか考察せよ。さらに、同様の解析をファイル{\tt measurement2.dat}に対して行ってみよ

\item Lanczos法により固有値を計算するプログラムを作成せよ。Ritz値が、繰り返しに従ってどのように振る舞うか図示してみよ。収束の速さをべき乗法と比較せよ

\item {\tt convert2matrix.py}は、JPEGやPNGなどの形式の画像ファイルをグレイスケールに変換し、行列の形で書き出すPythonスクリプトである。\footnote{実行には、Pillowライブラリが必要である。ceenvでは事前に、{\tt pip install pillow} (Python2)、あるいは{\tt pip3 install pillow} (Python3)する必要がある。} これを用いて画像ファイルを行列形式に変換した後、SVDで圧縮してみよ。どの程度まで圧縮可能か?

\item 二重井戸ポテンシャル
  \begin{equation*}
    V(x) = \begin{cases}
      \infty & x < 0, \ x > 1 \\
      0 & 0 < x < \frac{1}{2} - w/2, \ \frac{1}{2} + w/2 < x < 1 \\
      v & \frac{1}{2} - w/2 < x < \frac{1}{2} + w/2
    \end{cases}
  \end{equation*}
  中の1粒子問題
  \begin{equation*}
    {\cal H} \psi(x) = \Big[ -\frac{d^2}{dx^2} + V(x) \Big] \psi(x) = E \psi(x)
  \end{equation*}
  を考える($v \ge 0$, $0 < w < 1$)。変分波動関数として、$v=0$の場合の固有状態$\phi_n(x) = \sqrt{2} \sin(n \pi) \ (n=1,2,3\cdots)$の線形結合$\psi(x) = \sum_n C_n \phi_n(x)$を考える(ポテンシャルが左右対称なので実際には対称な波動関数(奇数の$n$)のみを考えれば十分である)。適当な$v$について、固有値問題$HC = EC$をハウスホルダー法を用いて数値的に解き、近似基底状態と近似基底エネルギーを求めよ。基底の数を増やすにつれて、近似基底エネルギーはどのように振る舞うか観察せよ。

さらに、基底関数として$v=\infty$の場合の固有状態[$0<x<(w-1)/2$と$(w+1)/2<x<1$に二つの井戸型ポテンシャルがある場合の固有状態のうち対称なもののみを考慮]も加えて数値的変分計算を行え。基底関数が互いに直交しないので、一般化固有値問題となることに注意せよ。

\end{enumerate}

\noindent {\bf [その他]}
\begin{enumerate}
\renewcommand{\labelenumi}{5-\arabic{enumi})}

\item \mbox{} [応用] 「\href{https://github.com/utphys-comp/handbook/releases/download/handbook-2019/handbook.pdf}{計算機実験ハンドブック}」の1.3節にEmacs以外のエディタの説明(vi (vim)、nano)を追加

\item \mbox{} [応用] 「\href{https://github.com/utphys-comp/handbook/releases/download/handbook-2021/handbook.pdf}{計算機実験ハンドブック}」の第2章「C言語入門」のC++言語版を追加

\end{enumerate}  
\end{document}
