\documentclass[11pt]{jarticle}

\usepackage{amsmath}
\usepackage{hyperref}

\setlength{\oddsidemargin}{-0.7cm}
\setlength{\topmargin}{-1.5cm}
\setlength{\textwidth}{16.5cm}
\setlength{\textheight}{26cm}
\pagestyle{empty}

\begin{document}

\noindent
{\bf\large 「計算機実験II」実習課題 (2020/10/02更新)}
\\[-0.5em]

\noindent
課題は順次追加\\[-0.5em]

%\noindent
%課題番号のあとに[応用]とあるのは少し高度な課題\\[-0.5em]

{\bf [モンテカルロ法]}
\begin{enumerate}

\item $X$と$Y$を$(0,1)$で一様分布するそれぞれ独立な(実数)確率変数とする。このとき$X^2$, $-\log X$, $XY$のそれぞれの確率密度関数と期待値を(解析的に)求めよ。また、実際に乱数を生成させてヒストグラムと期待値を計算し、解析的な結果と比較せよ。また、棄却法により、確率密度関数
  \begin{equation}
    P(x) = \begin{cases} 4x & 0 < x < 1/2 \\
      4(1-x) & 1/2 < x < 1 \\
      0 & \text{otherwise}
    \end{cases}
    \label{eqn:triangle}
  \end{equation}
  にしたがう一様乱数を生成せよ。ヒストグラムを作り、結果を確認せよ。さらに、確率密度関数(\ref{eqn:triangle})にしたがう$m=10$個の独立な確率変数の平均$Y=(1/m) \sum_{i=1}^m X_i$のヒストグラムを調べよ。$m$を増やしていくと分布はどのような形に近づくか予測し比較せよ。
  
\item 正規分布にしたがう乱数の生成方法について調べよ。また、平均値$\mu_i$と共分散行列$\Sigma_{ij}$をもつ多次元正規分布にしたがう乱数の生成方法を考え実装し、平均値と共分散が正しく得られるかどうか確認せよ

\item 板状の物質による中性子の吸収/透過/反射をモンテカルロ法により計算するプログラムを作成せよ。吸収率$p_{\rm c}$、平均自由行程$\lambda^{-1}$を適当な値に仮定した上で、板の厚さ$D$を増やしたときに、吸収率・透過率・反射率がどのように変化するか調べよ。エラーバー(統計誤差)についても評価すること

\item マルコフ連鎖モンテカルロ法により、二次元正方格子イジング模型のエネルギーと比熱、磁化の二乗の期待値を計算せよ。システムサイズを$L=4, 6,8\cdots$と増やすと、これらの物理量の振る舞いがどのように変化するか調べよ。また、有限系のシミュレーション結果から、熱力学的極限における二次相転移の臨界温度と臨界指数を求める方法について調べよ

\item 一次元イジング模型の物理量は、転送行列法を用いて厳密に計算可能である。マルコフ連鎖モンテカルロ法により計算した物理量と厳密解を比較し、一致するかどうか確認してみよ。システムサイズ依存性はどのようになっているか調べよ

\item サイト数$N$の格子上の強磁性イジング模型を考える(二次元正方格子あるいは一次元鎖)。$N$個のスピンの状態を$N$ビットの整数で表すことにする($i$番目($i=0,\cdots,N-1$)の格子点のスピンの状態を$i$ビット目に保存)。この整数が表す状態のエネルギーおよび磁化を計算するプログラムを作成せよ。さらに、全ての状態についてボルツマン重みの和を取ることにより、自由エネルギーを計算せよ。低温でも桁あふれが起こらないよう注意すること。十分低温における自由エネルギーの値が基底状態エネルギー(全てのスピンが同じ方向に揃った状態)と一致することを確認せよ。有限温度のエネルギーと比熱の期待値を計算しプロットせよ。(可能であれば、結果がマルコフ連鎖モンテカルロ法と一致することを確認せよ)

\item 転送行列法は、一次元イジング模型の厳密解を求める方法として統計力学の教科書に載っているが、二次元以上のイジング模型の数値計算にも有用である(講義資料{\tt lecture-2-2.pdf} pp.24-29)。例えば、$L\times M$の二次元正方格子の場合、長さ$2^M$のベクトルを準備する必要があるが、$O(LM(2^M)^2)$の計算量で分配関数の計算を行うことができる。あるいは、幅$M$で長さ$L=\infty$の分配関数を$O(M(2^M))$で計算できる。必要メモリ量も計算量も$M$に関して指数関数的に増加するが、計算量は厳密な数え上げ($O(2^{LM})$)と比較すると非常に少ない(例えば$L=M=10$では、$2^{LM}=2^{100}\approx 10^{30}$に対して、$LM(2^M)^2=100 \times (2^{10})^2 \approx 10^{2+3\times2} = 10^{8}$)。$L=M$の場合には$M=10$以上、$L=\infty$の場合には$M=20$以上の計算を行うことができる。転送行列法のプログラムを作成し、二次元イジング模型の自由エネルギーを計算せよ。さらに、数値微分を用いて、エネルギー・比熱の温度依存性を計算せよ。(可能であれば、結果がマルコフ連鎖モンテカルロ法と一致することを確認せよ)

\item 二次元正方格子上の古典ハイゼンベルグ模型のマルコフ連鎖モンテカルロ法のプログラムを作成する。まず、三次元単位球面上に一様に分布するランダムベクトルの生成方法について考えよ。次にメトロポリス法のプログラムを作成し、エネルギー・比熱・磁化の二乗の期待値を計算、その温度依存性・サイズ依存性をプロットせよ。(可能であれば、二次元正方格子上のイジング模型に対するモンテカルロ計算の結果との比較を行い、定性的な違いについて議論せよ)
  
  \hspace*{-2em} {\bf [その他]}

\item 「\href{https://github.com/utphys-comp/handbook/releases/download/handbook-2019/handbook.pdf}{計算機実験ハンドブック}」の1.3節にEmacs以外のエディタの説明(vi (vim)、nano)を追加

\item 「\href{https://github.com/utphys-comp/handbook/releases/download/handbook-2019/handbook.pdf}{計算機実験ハンドブック}」の第2章「C言語入門」のC++言語版を追加

\item Windows10のWSL2を使って計算機実験に必要な環境(C言語、BLAS/Lapack、Gnuplot、SSHなど)を整備する方法についてまとめる

\end{enumerate}  

\end{document}
